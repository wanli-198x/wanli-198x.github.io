# vitepress-plugin-file-content-loader

è¿™æ˜¯ä¸€ä¸ªé€‚ç”¨äº `vitepress` çš„ Vite æ’ä»¶ï¼Œåœ¨ `vitepress` å¯åŠ¨åæ‰«ææŒ‡å®šæ–‡ä»¶ï¼Œè¿”å›å«æœ‰æ–‡ä»¶æºå†…å®¹ã€æºå†…å®¹è½¬æ¢ HTMLã€æ–‡ä»¶è·¯å¾„ã€æ–‡ä»¶æ‘˜è¦ç­‰æ•°æ®ã€‚

## âœ¨ Feature

è¯¥æ’ä»¶æœ¬è´¨ä¸Šå°† vitepress å®˜ç½‘çš„ [æ„å»ºæ—¶æ•°æ®åŠ è½½](https://vitepress.dev/zh/guide/data-loading) åŠŸèƒ½è½¬ä¸ºæ’ä»¶ï¼Œå› æ­¤å…·ä½“çš„ä»‹ç»è¯´æ˜è¯·å‰å¾€ vitepress å®˜ç½‘é˜…è¯»ã€‚

## ğŸ•¯ï¸ Install

å®‰è£… `vitepress-plugin-file-content-loader` æ’ä»¶

```bash
# æ¨èä½¿ç”¨ pnpm
pnpm i vitepress-plugin-file-content-loader
# or yarn
yarn add vitepress-plugin-file-content-loader
# or npm
npm install vitepress-plugin-file-content-loader
```

æ·»åŠ  `vitepress-plugin-file-content-loader` æ’ä»¶åˆ° `.vitepress/config.ts`

```typescript
import { defineConfig } from "vitepress";
import FileContentLoader from "vitepress-plugin-file-content-loader";

export default defineConfig({
  vite: {
    plugins: [FileContentLoader(/* options */)],
  },
});
```

> è¯´æ˜ï¼šè¯¥æ’ä»¶ä»…é™é¡¹ç›®å¯åŠ¨æ—¶ç”Ÿæ•ˆï¼Œå·²æ”¹åŠ¨æˆ–æ–°æ·»åŠ çš„ Markdown éœ€è¦é‡å¯é¡¹ç›®æ‰èƒ½ç”Ÿæ•ˆã€‚

æ’ä»¶é»˜è®¤å¿½ç•¥ `[**/node_modules/**", "**/dist/**]` ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œä¸”åªæ‰«æ Markdown æ–‡æ¡£ã€‚

## ğŸ“– Usage

è·å–æ’ä»¶åˆ†æåçš„æ•°æ®ï¼š

```javascript
import { useData } from "vitepress";

const { theme } = useData();

// themeConfigKey é»˜è®¤ä¸º contentLoaderï¼Œå¦‚æœéœ€è¦ä¿®æ”¹è¯·æŸ¥çœ‹ Options é…ç½®é¡¹
const fileContent = theme.value.[themeConfigKey];
```

## ğŸ› ï¸ Options

### Parameters

| name           | description                                                           | type      | default         |
| -------------- | --------------------------------------------------------------------- | --------- | --------------- |
| pattern        | æ‰«æçš„æ–‡ä»¶è·¯å¾„è¡¨è¾¾å¼ï¼Œä¸º global è¡¨è¾¾å¼                                | `string`  | `string[]`      |
| includeSrc     | æ˜¯å¦è·å–æ–‡ä»¶çš„æºå†…å®¹ï¼Œå¹¶æ”¾åˆ°åœ¨æ•°æ®ä¸­                                  | `boolean` | `false`         |
| render         | æ˜¯å¦å°† src è½¬æ¢ä¸º HTML å¹¶æ”¾åˆ°åœ¨æ•°æ®ä¸­                                 | `boolean` | `false`         |
| excerpt        | 1 åˆ†é’Ÿå†…é˜…è¯»çš„ä¸­æ–‡å­—æ•°ï¼Œé˜…è¯»æ—¶é—´è®¡ç®—éœ€è¦                              | `number`  | 300             |
| globOptions    | tinyglobby çš„é…ç½®é¡¹                                                   | `number`  | 160             |
| themeConfigKey | æŒ‡å®š themeConfig çš„ä¸€ä¸ªä¸å­˜åœ¨çš„ keyï¼Œå°†å¤„ç†/è½¬æ¢çš„æ•°æ®æŒ‚åœ¨åˆ°è¯¥ key ä¸‹ | `string`  | `contentLoader` |

### Hooks

| name          | description                              | type                                              | default      |
| ------------- | ---------------------------------------- | ------------------------------------------------- | ------------ | --- |
| transformData | è½¬æ¢å¤„ç†å¥½çš„å•æ¡æ•°æ®ï¼Œå¹¶è¿”å›è½¬æ¢åçš„æ•°æ® | `(data: FileContentLoaderData) => T               | Promise<T> ` |     |
| includeSrc    | è½¬æ¢å¤„ç†å¥½çš„æ‰€æœ‰æ•°æ®ï¼Œå¹¶è¿”å›è½¬æ¢åçš„æ•°æ® | `(raw: (FileContentLoaderData Awaited<T>)[]) => R | Promise<R>`  |     |

## ğŸ“˜ TypeScript

### ğŸ› ï¸ Options

```typescript
import type { GlobOptions } from "tinyglobby";

export interface FileContentLoaderOptions<T = FileContentLoaderData, R = FileContentLoaderData[]> {
  /**
   * æ‰«æçš„æ–‡ä»¶è·¯å¾„è¡¨è¾¾å¼ï¼Œä¸º global è¡¨è¾¾å¼
   */
  pattern: string | string[];
  /**
   * æ˜¯å¦è·å–æ–‡ä»¶çš„æºå†…å®¹ï¼Œå¹¶æ”¾åˆ°åœ¨æ•°æ®ä¸­
   *
   * @default false
   */
  includeSrc?: boolean;

  /**
   * æ˜¯å¦å°† src è½¬æ¢ä¸º HTML å¹¶æ”¾åˆ°åœ¨æ•°æ®ä¸­
   *
   * @default false
   * @remark ä¸éœ€è¦è½¬æ¢ä¸º HTML æ—¶ï¼Œä¸è¦å°† render è®¾ä¸º trueï¼Œå¦åˆ™å†…å®¹è¿‡å¤§å¯¼è‡´å®¹æ˜“å†…å­˜æº¢å‡º
   */
  render?: boolean;

  /**
   * If `boolean`, whether to parse and include excerpt? (rendered as HTML)
   *
   * If `function`, control how the excerpt is extracted from the content.
   *
   * If `string`, define a custom separator to be used for extracting the
   * excerpt. Default separator is `---` if `excerpt` is `true`.
   *
   * @see https://github.com/jonschlinkert/gray-matter#optionsexcerpt
   * @see https://github.com/jonschlinkert/gray-matter#optionsexcerpt_separator
   *
   * @default false
   */
  excerpt?:
    | boolean
    | ((
        file: {
          data: { [key: string]: any };
          content: string;
          excerpt?: string;
        },
        options?: any
      ) => void)
    | string;

  /**
   * è½¬æ¢å¤„ç†å¥½çš„å•æ¡æ•°æ®ï¼Œå¹¶è¿”å›è½¬æ¢åçš„æ•°æ®
   *
   * @remark åœ¨è¿”å›è½¬æ¢åçš„æ•°æ®æ—¶ï¼Œå»ºè®®ä¸è¦è¿”å› src å’Œ htmlï¼Œå°¤å…¶æ˜¯ htmlï¼Œå®¹æ˜“æ•°æ®è¿‡å¤§å¯¼è‡´å®¹æ˜“å†…å­˜æº¢å‡ºã€‚src å’Œ html åˆ†åˆ«æ˜¯è®¾ç½® includeSrc å’Œ render ä¸º true æ—¶æ”¾å…¥ data ä¸­
   */
  transformData?: (data: FileContentLoaderData) => T | Promise<T>;

  /**
   * è½¬æ¢å¤„ç†å¥½çš„æ‰€æœ‰æ•°æ®ï¼Œå¹¶è¿”å›è½¬æ¢åçš„æ•°æ®
   *
   * @remark åœ¨è¿”å›è½¬æ¢åçš„æ•°æ®æ—¶ï¼Œå»ºè®®ä¸è¦è¿”å› src å’Œ htmlï¼Œå°¤å…¶æ˜¯ htmlï¼Œå®¹æ˜“æ•°æ®è¿‡å¤§å¯¼è‡´å®¹æ˜“å†…å­˜æº¢å‡ºã€‚src å’Œ html åˆ†åˆ«æ˜¯è®¾ç½® includeSrc å’Œ render ä¸º true æ—¶æ”¾å…¥ data ä¸­
   */
  transformRaw?: (raw: (FileContentLoaderData | Awaited<T>)[]) => R | Promise<R>;

  /**
   * tinyglobby çš„é…ç½®é¡¹
   * æ’ä»¶é»˜è®¤å·²ç»å¿½ç•¥ node_modules å’Œ dist ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶
   */
  globOptions?: GlobOptions;
  /**
   * æŒ‡å®š themeConfig çš„ä¸€ä¸ªä¸å­˜åœ¨çš„ keyï¼Œå°†å¤„ç†/è½¬æ¢çš„æ•°æ®æŒ‚åœ¨åˆ°è¯¥ key ä¸‹
   *
   * @default contentLoader
   * @remark å¦‚æœæ²¡æœ‰ä¼ å…¥ themeConfigKeyï¼Œåˆ™å¯ä»¥é€šè¿‡ themeConfig.contentLoader è·å–å¤„ç†/è½¬æ¢çš„æ•°æ®
   */
  themeConfigKey?: string;
}

export interface FileContentLoaderData {
  /**
   * æ–‡ä»¶çš„è®¿é—® url
   */
  url: string;
  /**
   * æ–‡ä»¶çš„æºå†…å®¹
   */
  src?: string;
  /**
   * src è½¬æ¢åçš„ html
   */
  html?: string;
  /**
   * æ–‡ä»¶çš„ frontmatter æ•°æ®
   */
  frontmatter: Record<string, any>;
  /**
   * æ–‡ä»¶æ‘˜è¦æ ¼å¼
   */
  excerpt?: string;
}
```

## ğŸ‰‘ License

[MIT](../../LICENSE) License Â© 2025 [Teeker](https://github.com/Kele-Bingtang)
