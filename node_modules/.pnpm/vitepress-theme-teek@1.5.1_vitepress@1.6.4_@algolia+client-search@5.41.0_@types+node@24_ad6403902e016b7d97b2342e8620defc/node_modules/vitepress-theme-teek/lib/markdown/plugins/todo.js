'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

const todoUncheck = "[ ] ";
const todoCheck = "[x] ";
const todoPlugin = (md) => {
  md.renderer.rules.list_item_open = (tokens, idx, options, _, self) => {
    for (let i = idx + 1; i < tokens.length; i++) {
      const token = tokens[i];
      if (token.type === "list_item_close") break;
      const content = token.content;
      if (content?.startsWith(todoUncheck) || content?.startsWith(todoCheck)) {
        const isChecked = content.startsWith(todoCheck);
        const checkbox = `<input class="todo-checkbox" type="checkbox" ${isChecked ? "checked" : ""} disabled />`;
        token.content = content.slice(4);
        if (token.children) token.children[0].content = token.children[0].content.slice(4);
        return `<li class="todo">${checkbox}`;
      }
    }
    return self.renderToken(tokens, idx, options);
  };
};

exports.default = todoPlugin;
