import { defineComponent, provide, computed, ref, watch, createElementBlock, createBlock, unref, openBlock, Fragment, createCommentVNode, renderSlot, withDirectives, withCtx, normalizeProps, guardReactiveProps, createVNode, vShow, createSlots, renderList, normalizeClass, resolveDynamicComponent, mergeProps } from 'vue';
import DefaultTheme from 'vitepress/theme';
import { useData, onContentUpdated } from 'vitepress';
import { isBoolean, isClient } from '../../../../helper/dist/index.mjs';
import { useNamespace } from '../../../../composables/useNamespace.mjs';
import 'vitepress-theme-teek/theme-chalk/tk-copy-banner.css';
import { localeContextKey } from '../../../../composables/useLocale.mjs';
import '../../../../composables/useZIndex.mjs';
import { useTeekConfig, usePageState, useSidebar } from '../../ConfigProvider/index.mjs';
import _sfc_main$w from '../../Home/src/index.vue2.mjs';
import _sfc_main$q from '../../HomeMyCard/src/HomeMyCardScreen.vue2.mjs';
import _sfc_main$8 from '../../BodyBgImage/src/index.vue2.mjs';
import _sfc_main$r from '../../FooterGroup/src/index.vue2.mjs';
import _sfc_main$s from '../../FooterInfo/src/index.vue2.mjs';
import _sfc_main$m from '../../ArticleImagePreview/src/index.vue2.mjs';
import _sfc_main$l from '../../ArticleAnalyze/src/index.vue2.mjs';
import _sfc_main$c from '../../ArticleShare/src/index.vue2.mjs';
import _sfc_main$h from '../../ArticleUpdate/src/index.vue2.mjs';
import _sfc_main$9 from '../../ArticleHeadingHighlight/src/index.vue2.mjs';
import _sfc_main$n from '../../ArticlePageStyle/src/index.vue2.mjs';
import _sfc_main$g from '../../ArticleAppreciation/src/AsideBottomAppreciation.vue2.mjs';
import _sfc_main$i from '../../ArticleAppreciation/src/DocAfterAppreciation.vue2.mjs';
import _sfc_main$j from '../../ArticleAppreciation/src/DocAfterAppreciationPopper.vue2.mjs';
import _sfc_main$4 from '../../CommentTwikoo/src/index.vue2.mjs';
import _sfc_main$1 from '../../CommentArtalk/src/index.vue2.mjs';
import _sfc_main$2 from '../../CommentGiscus/src/index.vue2.mjs';
import _sfc_main$3 from '../../CommentWaline/src/index.vue2.mjs';
import _sfc_main$o from '../../CodeBlockToggle/src/index.vue2.mjs';
import _sfc_main$b from '../../RightBottomButton/src/index.vue2.mjs';
import _sfc_main$a from '../../Notice/src/index.vue2.mjs';
import _sfc_main$u from '../../ThemeEnhance/src/index.vue2.mjs';
import _sfc_main$k from '../../../common/VpContainer/src/index.vue2.mjs';
import _sfc_main$d from '../../ArchivesPage/src/index.vue2.mjs';
import _sfc_main$e from '../../CataloguePage/src/index.vue2.mjs';
import _sfc_main$f from '../../ArticleOverviewPage/src/index.vue2.mjs';
import _sfc_main$6 from '../../LoginPage/src/index.vue2.mjs';
import { useWatchLogin } from '../../LoginPage/src/useWatchLogin.mjs';
import _sfc_main$7 from '../../RiskLinkPage/src/index.vue2.mjs';
import { useRiskLink } from '../../RiskLinkPage/src/useRiskLink.mjs';
import _sfc_main$p from '../../SidebarTrigger/src/index.vue2.mjs';
import _sfc_main$v from '../../HomeFeature/src/index.vue2.mjs';
import _sfc_main$5 from '../../RouteLoading/src/index.vue.mjs';
import _sfc_main$t from '../../ArticleBanner/src/index.vue2.mjs';

var _sfc_main = /* @__PURE__ */ defineComponent({
  ...{ name: "TeekLayout" },
  __name: "index",
  props: {
    locale: {}
  },
  setup(__props) {
    const props = __props;
    provide(
      localeContextKey,
      computed(() => props.locale)
    );
    const { Layout } = DefaultTheme;
    const ns = useNamespace("layout");
    const { getTeekConfigRef } = useTeekConfig();
    const { isHomePage, isArchivesPage, isCataloguePage, isArticleOverviewPage } = usePageState();
    const { frontmatter, localeIndex, page } = useData();
    const { hasSidebar } = useSidebar();
    const teekConfig = getTeekConfigRef(null, {
      teekTheme: true,
      teekHome: true,
      vpHome: true,
      sidebarTrigger: false,
      loading: false,
      codeBlock: { enabled: true },
      themeSize: "",
      bodyBgImg: {},
      notice: {},
      comment: { provider: "" },
      articleUpdate: { enabled: true },
      articleTopTip: void 0,
      articleBottomTip: void 0,
      articleShare: {},
      appreciation: {},
      riskLink: { enabled: false },
      themeEnhance: { enabled: true },
      articleBanner: { enabled: false },
      pageStyle: "default"
    });
    const loading = ref(teekConfig.value.loading);
    const commentConfig = computed(() => {
      const comment = frontmatter.value.comment ?? teekConfig.value.comment;
      if (isBoolean(comment)) return { enabled: comment };
      return {
        enabled: true,
        components: {
          twikoo: _sfc_main$4,
          waline: _sfc_main$3,
          giscus: _sfc_main$2,
          artalk: _sfc_main$1
        },
        provider: comment.provider,
        options: comment.options
      };
    });
    const topTipConfig = computed(() => {
      if (isBoolean(teekConfig.value.articleTopTip)) return teekConfig.value.articleTopTip;
      return teekConfig.value.articleTopTip?.(frontmatter.value, localeIndex.value, page.value);
    });
    const bottomTipConfig = computed(() => {
      if (isBoolean(teekConfig.value.articleBottomTip)) return teekConfig.value.articleBottomTip;
      return teekConfig.value.articleBottomTip?.(frontmatter.value, localeIndex.value, page.value);
    });
    const showArticleBanner = computed(
      () => frontmatter.value.articleBanner !== false && teekConfig.value.articleBanner.enabled && !hasSidebar.value && frontmatter.value.article !== false && (!frontmatter.value.layout || frontmatter.value.layout === "doc") && teekConfig.value.pageStyle === "default"
    );
    const themeSizeAttribute = ns.join("theme-size");
    watch(
      () => teekConfig.value.themeSize,
      (newValue) => {
        if (!isClient) return;
        if (newValue) document.documentElement.setAttribute(themeSizeAttribute, newValue);
        else document.documentElement.removeAttribute(themeSizeAttribute);
      },
      { immediate: true, flush: "post" }
    );
    const { watchSite, watchPages } = useWatchLogin();
    const { restart } = useRiskLink({
      whitelist: teekConfig.value.riskLink.whitelist,
      blacklist: teekConfig.value.riskLink.blacklist
    });
    watchSite();
    watchPages();
    onContentUpdated(() => {
      if (teekConfig.value.riskLink.enabled) restart();
    });
    const usedSlots = [
      "home-hero-before",
      "home-features-after",
      "nav-bar-content-after",
      "layout-top",
      "layout-bottom",
      "doc-footer-before",
      "doc-before",
      "doc-after",
      "aside-bottom",
      "page-top",
      "aside-outline-before",
      "sidebar-nav-before"
    ];
    return (_ctx, _cache) => {
      return unref(teekConfig).teekTheme ? (openBlock(), createElementBlock(
        Fragment,
        { key: 0 },
        [
          unref(teekConfig).loading ?? false ? (openBlock(), createBlock(unref(_sfc_main$5), {
            key: 0,
            modelValue: loading.value,
            "onUpdate:modelValue": _cache[0] || (_cache[0] = ($event) => loading.value = $event)
          }, {
            default: withCtx((scope) => [
              renderSlot(_ctx.$slots, "teek-loading", normalizeProps(guardReactiveProps(scope)))
            ]),
            _: 3
            /* FORWARDED */
          }, 8, ["modelValue"])) : createCommentVNode("v-if", true),
          unref(frontmatter).loginPage === true ? renderSlot(_ctx.$slots, "teek-login-page", { key: 1 }, () => [
            withDirectives(createVNode(
              unref(_sfc_main$6),
              null,
              null,
              512
              /* NEED_PATCH */
            ), [
              [vShow, !loading.value]
            ])
          ]) : createCommentVNode("v-if", true),
          unref(frontmatter).riskLinkPage === true ? renderSlot(_ctx.$slots, "teek-risk-link-page", { key: 2 }, () => [
            withDirectives(createVNode(
              unref(_sfc_main$7),
              null,
              null,
              512
              /* NEED_PATCH */
            ), [
              [vShow, !loading.value]
            ])
          ]) : createCommentVNode("v-if", true),
          unref(frontmatter).layout !== false ? (openBlock(), createElementBlock(
            Fragment,
            { key: 3 },
            [
              unref(teekConfig).bodyBgImg?.imgSrc ? (openBlock(), createBlock(unref(_sfc_main$8), { key: 0 })) : createCommentVNode("v-if", true),
              createVNode(unref(_sfc_main$9)),
              unref(teekConfig).notice?.enabled ? (openBlock(), createBlock(
                unref(_sfc_main$a),
                { key: 1 },
                createSlots({
                  _: 2
                  /* DYNAMIC */
                }, [
                  renderList(_ctx.$slots, (_, name) => {
                    return {
                      name,
                      fn: withCtx((scope) => [
                        renderSlot(_ctx.$slots, name, normalizeProps(guardReactiveProps(scope)))
                      ])
                    };
                  })
                ]),
                1024
                /* DYNAMIC_SLOTS */
              )) : createCommentVNode("v-if", true),
              createVNode(
                unref(_sfc_main$b),
                null,
                createSlots({
                  _: 2
                  /* DYNAMIC */
                }, [
                  renderList(_ctx.$slots, (_, name) => {
                    return {
                      name,
                      fn: withCtx((scope) => [
                        renderSlot(_ctx.$slots, name, normalizeProps(guardReactiveProps(scope)))
                      ])
                    };
                  })
                ]),
                1024
                /* DYNAMIC_SLOTS */
              )
            ],
            64
            /* STABLE_FRAGMENT */
          )) : createCommentVNode("v-if", true),
          withDirectives(createVNode(unref(Layout), {
            class: normalizeClass([
              unref(ns).b(),
              { [unref(ns).m("hide-vp-home")]: !unref(teekConfig).vpHome },
              unref(ns).has("sidebar-trigger", unref(teekConfig).sidebarTrigger)
            ])
          }, createSlots({
            "home-hero-before": withCtx(() => [
              renderSlot(_ctx.$slots, "home-hero-before"),
              renderSlot(_ctx.$slots, "teek-home-before"),
              createCommentVNode(" \u81EA\u5B9A\u4E49\u9996\u9875 "),
              unref(teekConfig).teekHome ? (openBlock(), createBlock(
                unref(_sfc_main$w),
                { key: 0 },
                createSlots({
                  _: 2
                  /* DYNAMIC */
                }, [
                  renderList(_ctx.$slots, (_, name) => {
                    return {
                      name,
                      fn: withCtx((scope) => [
                        renderSlot(_ctx.$slots, name, normalizeProps(guardReactiveProps(scope)))
                      ])
                    };
                  })
                ]),
                1024
                /* DYNAMIC_SLOTS */
              )) : createCommentVNode("v-if", true),
              renderSlot(_ctx.$slots, "teek-home-after")
            ]),
            "home-features-after": withCtx(() => [
              !unref(teekConfig).teekHome ? (openBlock(), createElementBlock(
                Fragment,
                { key: 0 },
                [
                  renderSlot(_ctx.$slots, "teek-home-features-before"),
                  createVNode(unref(_sfc_main$v)),
                  renderSlot(_ctx.$slots, "teek-home-features-after")
                ],
                64
                /* STABLE_FRAGMENT */
              )) : createCommentVNode("v-if", true),
              renderSlot(_ctx.$slots, "home-features-after")
            ]),
            "nav-bar-content-after": withCtx(() => [
              renderSlot(_ctx.$slots, "nav-bar-content-after"),
              unref(teekConfig).themeEnhance.enabled ?? true ? (openBlock(), createBlock(
                unref(_sfc_main$u),
                { key: 0 },
                createSlots({
                  _: 2
                  /* DYNAMIC */
                }, [
                  renderList(_ctx.$slots, (_, name) => {
                    return {
                      name,
                      fn: withCtx((scope) => [
                        renderSlot(_ctx.$slots, name, normalizeProps(guardReactiveProps(scope)))
                      ])
                    };
                  })
                ]),
                1024
                /* DYNAMIC_SLOTS */
              )) : createCommentVNode("v-if", true)
            ]),
            "layout-top": withCtx(() => [
              renderSlot(_ctx.$slots, "layout-top"),
              showArticleBanner.value ? (openBlock(), createElementBlock(
                Fragment,
                { key: 0 },
                [
                  renderSlot(_ctx.$slots, "teek-article-banner-before"),
                  createVNode(
                    unref(_sfc_main$t),
                    null,
                    createSlots({
                      _: 2
                      /* DYNAMIC */
                    }, [
                      renderList(_ctx.$slots, (_, name) => {
                        return {
                          name,
                          fn: withCtx((scope) => [
                            renderSlot(_ctx.$slots, name, normalizeProps(guardReactiveProps(scope)))
                          ])
                        };
                      })
                    ]),
                    1024
                    /* DYNAMIC_SLOTS */
                  ),
                  renderSlot(_ctx.$slots, "teek-article-banner-after")
                ],
                64
                /* STABLE_FRAGMENT */
              )) : createCommentVNode("v-if", true)
            ]),
            "layout-bottom": withCtx(() => [
              unref(isHomePage) ? (openBlock(), createElementBlock(
                Fragment,
                { key: 0 },
                [
                  renderSlot(_ctx.$slots, "teek-footer-group-before"),
                  createVNode(unref(_sfc_main$r)),
                  renderSlot(_ctx.$slots, "teek-footer-group-after"),
                  renderSlot(_ctx.$slots, "teek-footer-info-before"),
                  renderSlot(_ctx.$slots, "teek-footer-info", {}, () => [
                    createVNode(unref(_sfc_main$s))
                  ]),
                  renderSlot(_ctx.$slots, "teek-footer-info-after")
                ],
                64
                /* STABLE_FRAGMENT */
              )) : createCommentVNode("v-if", true),
              renderSlot(_ctx.$slots, "layout-bottom")
            ]),
            "sidebar-nav-before": withCtx(() => [
              createVNode(unref(_sfc_main$q))
            ]),
            "doc-before": withCtx(() => [
              renderSlot(_ctx.$slots, "doc-before"),
              unref(frontmatter).article !== false && !showArticleBanner.value ? (openBlock(), createElementBlock(
                Fragment,
                { key: 0 },
                [
                  renderSlot(_ctx.$slots, "teek-article-analyze-before"),
                  createVNode(unref(_sfc_main$l)),
                  renderSlot(_ctx.$slots, "teek-article-analyze-after")
                ],
                64
                /* STABLE_FRAGMENT */
              )) : createCommentVNode("v-if", true),
              createVNode(unref(_sfc_main$m)),
              createVNode(unref(_sfc_main$n)),
              unref(teekConfig).codeBlock.enabled ?? true ? (openBlock(), createBlock(unref(_sfc_main$o), { key: 1 })) : createCommentVNode("v-if", true),
              topTipConfig.value ? (openBlock(), createBlock(
                unref(_sfc_main$k),
                normalizeProps(mergeProps({ key: 2 }, unref(isBoolean)(topTipConfig.value) ? {} : topTipConfig.value)),
                null,
                16
                /* FULL_PROPS */
              )) : createCommentVNode("v-if", true),
              unref(teekConfig).sidebarTrigger ? (openBlock(), createBlock(unref(_sfc_main$p), { key: 3 }, {
                default: withCtx((scope) => [
                  renderSlot(_ctx.$slots, "teek-sidebar-trigger", normalizeProps(guardReactiveProps(scope)))
                ]),
                _: 3
                /* FORWARDED */
              })) : createCommentVNode("v-if", true)
            ]),
            "doc-footer-before": withCtx(() => [
              renderSlot(_ctx.$slots, "doc-footer-before"),
              bottomTipConfig.value ? (openBlock(), createElementBlock(
                Fragment,
                { key: 0 },
                [
                  renderSlot(_ctx.$slots, "teek-article-bottom-tip-before"),
                  createVNode(
                    unref(_sfc_main$k),
                    normalizeProps(guardReactiveProps(unref(isBoolean)(bottomTipConfig.value) ? {} : bottomTipConfig.value)),
                    null,
                    16
                    /* FULL_PROPS */
                  ),
                  renderSlot(_ctx.$slots, "teek-article-bottom-tip-after")
                ],
                64
                /* STABLE_FRAGMENT */
              )) : createCommentVNode("v-if", true)
            ]),
            "doc-after": withCtx(() => [
              renderSlot(_ctx.$slots, "doc-after"),
              (unref(teekConfig).articleUpdate.enabled ?? true) && unref(frontmatter).articleUpdate !== false ? (openBlock(), createElementBlock(
                Fragment,
                { key: 0 },
                [
                  renderSlot(_ctx.$slots, "teek-doc-update-before"),
                  createVNode(unref(_sfc_main$h)),
                  renderSlot(_ctx.$slots, "teek-doc-update-after")
                ],
                64
                /* STABLE_FRAGMENT */
              )) : createCommentVNode("v-if", true),
              ["doc-after", "doc-after-popper"].includes(unref(teekConfig).appreciation.position) ? (openBlock(), createElementBlock(
                Fragment,
                { key: 1 },
                [
                  renderSlot(_ctx.$slots, "teek-doc-after-appreciation-before"),
                  unref(teekConfig).appreciation.position === "doc-after" ? (openBlock(), createBlock(unref(_sfc_main$i), { key: 0 })) : unref(teekConfig).appreciation.position === "doc-after-popper" ? (openBlock(), createBlock(unref(_sfc_main$j), { key: 1 })) : createCommentVNode("v-if", true),
                  renderSlot(_ctx.$slots, "teek-doc-after-appreciation-after")
                ],
                64
                /* STABLE_FRAGMENT */
              )) : createCommentVNode("v-if", true),
              createCommentVNode(" \u8BC4\u8BBA\u533A "),
              commentConfig.value.enabled && commentConfig.value.provider ? (openBlock(), createElementBlock(
                Fragment,
                { key: 2 },
                [
                  renderSlot(_ctx.$slots, "teek-comment-before"),
                  commentConfig.value.provider === "render" ? renderSlot(_ctx.$slots, "teek-comment", { key: 0 }) : (openBlock(), createBlock(resolveDynamicComponent(commentConfig.value.components?.[commentConfig.value.provider]), {
                    key: 1,
                    id: `${unref(ns).namespace}-comment`,
                    class: normalizeClass(unref(ns).e("comment"))
                  }, null, 8, ["id", "class"])),
                  renderSlot(_ctx.$slots, "teek-comment-after")
                ],
                64
                /* STABLE_FRAGMENT */
              )) : createCommentVNode("v-if", true)
            ]),
            "aside-bottom": withCtx(() => [
              renderSlot(_ctx.$slots, "aside-bottom"),
              unref(teekConfig).appreciation.position === "aside-bottom" ? (openBlock(), createElementBlock(
                Fragment,
                { key: 0 },
                [
                  renderSlot(_ctx.$slots, "teek-aside-bottom-appreciation-before"),
                  createVNode(unref(_sfc_main$g)),
                  renderSlot(_ctx.$slots, "teek-aside-bottom-appreciation-after")
                ],
                64
                /* STABLE_FRAGMENT */
              )) : createCommentVNode("v-if", true)
            ]),
            "page-top": withCtx(() => [
              renderSlot(_ctx.$slots, "page-top"),
              unref(isArchivesPage) || unref(isCataloguePage) || unref(isArticleOverviewPage) ? (openBlock(), createElementBlock(
                Fragment,
                { key: 0 },
                [
                  renderSlot(_ctx.$slots, "teek-page-top-before"),
                  unref(isArchivesPage) ? (openBlock(), createBlock(
                    unref(_sfc_main$d),
                    { key: 0 },
                    createSlots({
                      _: 2
                      /* DYNAMIC */
                    }, [
                      renderList(_ctx.$slots, (_, name) => {
                        return {
                          name,
                          fn: withCtx((scope) => [
                            renderSlot(_ctx.$slots, name, normalizeProps(guardReactiveProps(scope)))
                          ])
                        };
                      })
                    ]),
                    1024
                    /* DYNAMIC_SLOTS */
                  )) : unref(isCataloguePage) ? (openBlock(), createBlock(
                    unref(_sfc_main$e),
                    { key: 1 },
                    createSlots({
                      _: 2
                      /* DYNAMIC */
                    }, [
                      renderList(_ctx.$slots, (_, name) => {
                        return {
                          name,
                          fn: withCtx((scope) => [
                            renderSlot(_ctx.$slots, name, normalizeProps(guardReactiveProps(scope)))
                          ])
                        };
                      })
                    ]),
                    1024
                    /* DYNAMIC_SLOTS */
                  )) : unref(isArticleOverviewPage) ? (openBlock(), createBlock(unref(_sfc_main$f), { key: 2 })) : createCommentVNode("v-if", true),
                  renderSlot(_ctx.$slots, "teek-page-top-after")
                ],
                64
                /* STABLE_FRAGMENT */
              )) : createCommentVNode("v-if", true)
            ]),
            "aside-outline-before": withCtx(() => [
              unref(teekConfig).articleShare.enabled ? (openBlock(), createElementBlock(
                Fragment,
                { key: 0 },
                [
                  renderSlot(_ctx.$slots, "teek-article-share-before"),
                  createVNode(unref(_sfc_main$c)),
                  renderSlot(_ctx.$slots, "teek-article-share-after")
                ],
                64
                /* STABLE_FRAGMENT */
              )) : createCommentVNode("v-if", true),
              renderSlot(_ctx.$slots, "aside-outline-before")
            ]),
            _: 2
            /* DYNAMIC */
          }, [
            renderList(Object.keys(_ctx.$slots).filter((name) => !usedSlots.includes(name)), (name) => {
              return {
                name,
                fn: withCtx((slotData) => [
                  renderSlot(_ctx.$slots, name, normalizeProps(guardReactiveProps(slotData)))
                ])
              };
            })
          ]), 1032, ["class"]), [
            [vShow, !loading.value]
          ])
        ],
        64
        /* STABLE_FRAGMENT */
      )) : (openBlock(), createBlock(
        unref(Layout),
        { key: 1 },
        createSlots({
          _: 2
          /* DYNAMIC */
        }, [
          renderList(_ctx.$slots, (_, name) => {
            return {
              name,
              fn: withCtx((slotData) => [
                renderSlot(_ctx.$slots, name, normalizeProps(guardReactiveProps(slotData)))
              ])
            };
          })
        ]),
        1024
        /* DYNAMIC_SLOTS */
      ));
    };
  }
});

export { _sfc_main as default };
