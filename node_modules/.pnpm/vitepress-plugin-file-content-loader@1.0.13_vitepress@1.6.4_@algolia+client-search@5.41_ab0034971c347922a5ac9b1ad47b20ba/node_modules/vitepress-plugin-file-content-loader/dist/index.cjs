"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const node_fs=require("node:fs"),vite=require("vite"),A=require("gray-matter"),tinyglobby=require("tinyglobby"),vitepress=require("vitepress"),node_path=require("node:path"),e=require("picocolors");function _interopDefaultCompat(t){return t&&typeof t=="object"&&"default"in t?t.default:t}const A__default=_interopDefaultCompat(A),e__default=_interopDefaultCompat(e),version="1.0.13",logger=vite.createLogger("info",{prefix:`[vitepress-plugin-file-content-loader v${version}]`}),info=(t,r="green",n={timestamp:!0})=>{logger.info(e__default[r](t),n)},warn=(t,r="yellow",n={timestamp:!0})=>{logger.warn(e__default[r](t),n)},warnOnce=(t,r="yellow",n={timestamp:!0})=>{logger.info(e__default[r](t),n)},error=(t,r="red",n={timestamp:!0})=>{logger.error(e__default[r](t),n)},k={info,warn,warnOnce,error},DEFAULT_IGNORE_DIR=["**/node_modules/**","**/dist/**"];function V(t){let r=!1;return{name:"vite-plugin-vitepress-file-content-loader",async config(n){if(r)return;r=!0;let{pattern:o}=t;if(!o)return;const{includeSrc:w=!1,render:x=!1,excerpt:s,transformData:d,transformRaw:f,globOptions:m,themeConfigKey:a="contentLoader"}=t,{site:{themeConfig:b={},base:D},srcDir:c,cleanUrls:g,markdown:$,rewrites:q}=n.vitepress;typeof o=="string"&&(o=[o]),o=o.map(i=>vite.normalizePath(node_path.join(c,i)));const E=(await tinyglobby.glob(o,{expandDirectories:!1,...m,ignore:["**/node_modules/**","**/dist/**",...m?.ignore||[]]})).sort(),v=await vitepress.createMarkdownRenderer(c,$,D,logger),l=[];for(const i of E){if(!i.endsWith(".md"))continue;const u=node_fs.readFileSync(i,"utf-8"),{data:R,excerpt:y}=A__default(u,typeof s=="string"?{excerpt_separator:s}:{excerpt:s}),p=vite.normalizePath(node_path.relative(c,i)).replace(/(^|\/)index\.md$/,"$1"),O="/"+p.replace(/\.md$/,g?"":".html"),C="/"+(q.map[p]||p).replace(/\.md$/,g?"":".html"),F=x?v.render(u):void 0,I=s&&y?.endsWith(`
`)?v.render(y):void 0,h={src:w?u:void 0,html:F,frontmatter:R,excerpt:I,relativePath:O,url:C};l.push(d?await d(h):h)}b[a]=f?await f(l):l;const _=a.charAt(0).toUpperCase()+a.slice(1);k.info(`Injected ${_} Data Successfully. \u6CE8\u5165 ${_} \u6570\u636E\u6210\u529F!`)}}}exports.DEFAULT_IGNORE_DIR=DEFAULT_IGNORE_DIR,exports.default=V;
