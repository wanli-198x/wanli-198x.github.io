import { shallowRef } from 'vue';
import { isClient } from '../helper/dist/index.mjs';
import { useEventListener } from './useEventListener.mjs';

const useElementHover = (el, options = {}) => {
  const { delayEnter = 0, delayLeave = 0 } = options;
  const isHovered = shallowRef(false);
  let timer;
  const toggle = (entering) => {
    const delay = entering ? delayEnter : delayLeave;
    if (timer) {
      clearTimeout(timer);
      timer = null;
    }
    if (delay) timer = setTimeout(() => isHovered.value = entering, delay);
    else isHovered.value = entering;
  };
  if (!isClient) return isHovered;
  useEventListener(el, "mouseenter", () => toggle(true), { passive: true });
  useEventListener(el, "mouseleave", () => toggle(false), { passive: true });
  return isHovered;
};

export { useElementHover };
