import { isClient } from '../../../../helper/dist/index.mjs';
import { layoutModeAttribute } from './themeEnhance.mjs';
import { toValue } from 'vue';
import { useScopeDispose } from '../../../../composables/useScopeDispose.mjs';
import 'vitepress';
import 'vitepress-theme-teek/theme-chalk/tk-copy-banner.css';
import '../../../../composables/useZIndex.mjs';

const useAnimated = (delay = 1e3, immediate = false) => {
  let timer = null;
  const stop = () => {
    if (timer) {
      clearTimeout(timer);
      timer = null;
    }
  };
  const start = () => {
    if (!isClient) return;
    if (!immediate) {
      immediate = true;
      return;
    }
    stop();
    document.documentElement.setAttribute(`${layoutModeAttribute}-animated`, "true");
    timer = setTimeout(() => {
      document.documentElement.removeAttribute(`${layoutModeAttribute}-animated`);
    }, toValue(delay));
  };
  useScopeDispose(stop);
  return { start, stop };
};

export { useAnimated };
