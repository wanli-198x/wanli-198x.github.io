'use strict';

var Vue = require('vue');
var useMounted = require('./useMounted.js');
var useEventListener = require('./useEventListener.js');

const useMediaQuery = (query, match = true) => {
  const isSupported = Vue.shallowRef(false);
  useMounted.useMounted(() => {
    isSupported.value = window && "matchMedia" in window && typeof window.matchMedia === "function";
  });
  const mediaQuery = Vue.shallowRef();
  const matches = Vue.shallowRef(false);
  const handler = (event) => {
    matches.value = event.matches;
  };
  Vue.watchEffect(() => {
    if (!isSupported.value) return;
    mediaQuery.value = window.matchMedia(Vue.toValue(query));
    matches.value = mediaQuery.value.matches;
  });
  useEventListener.useEventListener(mediaQuery, "change", handler, { passive: true });
  return Vue.computed(() => match ? matches.value : !matches.value);
};

exports.useMediaQuery = useMediaQuery;
